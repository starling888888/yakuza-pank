# タスク: [機能名]

**入力**: `/specs/[###-feature-name]/`からの設計ドキュメント
**前提条件**: plan.md (必須), research.md, data-model.md, contracts/

## 実行フロー (メイン)
```
1. 機能ディレクトリからplan.mdをロード
   → 見つからない場合: エラー「実装計画が見つかりません」
   → 抽出: 技術スタック、ライブラリ、構造
2. オプションの設計ドキュメントをロード:
   → data-model.md: エンティティを抽出 → モデルタスク
   → contracts/: 各ファイル → 契約テストタスク
   → research.md: 決定を抽出 → セットアップタスク
3. カテゴリ別にタスクを生成:
   → セットアップ: プロジェクト初期化、依存関係、リンティング
   → テスト: 契約テスト、統合テスト
   → コア: モデル、サービス、CLIコマンド
   → 統合: DB、ミドルウェア、ロギング
   → 磨き上げ: 単体テスト、パフォーマンス、ドキュメント
4. タスクルールを適用:
   → 異なるファイル = 並列実行のために [P] をマーク
   → 同じファイル = 順次実行 ([P]なし)
   → 実装前にテスト (TDD)
5. タスクを順次番号付け (T001, T002...)
6. 依存関係グラフを生成
7. 並列実行の例を作成
8. タスクの完了を検証:
   → すべての契約にテストがあるか？
   → すべてのエンティティにモデルがあるか？
   → すべてのエンドポイントが実装されているか？
9. 戻り値: 成功 (タスクは実行準備完了)
```

## 形式: `[ID] [P?] 説明`
- **[P]**: 並列実行可能 (異なるファイル、依存関係なし)
- 説明に正確なファイルパスを含める

## パス規則
- **単一プロジェクト**: リポジトリルートに`src/`、`tests/`
- **ウェブアプリ**: `backend/src/`、`frontend/src/`
- **モバイル**: `api/src/`、`ios/src/` または `android/src/`
- 以下に示すパスは単一プロジェクトを想定しています - plan.mdの構造に基づいて調整してください

## フェーズ3.1: セットアップ
- [ ] T001 実装計画に従ってプロジェクト構造を作成
- [ ] T002 [言語]プロジェクトを[フレームワーク]依存関係で初期化
- [ ] T003 [P] リンティングおよびフォーマットツールを設定

## フェーズ3.2: テストファースト (TDD) ⚠️ 3.3の前に完了必須
**重要: これらのテストは、いかなる実装の前に書かれ、失敗しなければなりません**
- [ ] T004 [P] tests/contract/test_users_post.pyのPOST /api/usersの契約テスト
- [ ] T005 [P] tests/contract/test_users_get.pyのGET /api/users/{id}の契約テスト
- [ ] T006 [P] tests/integration/test_registration.pyのユーザー登録の統合テスト
- [ ] T007 [P] tests/integration/test_auth.pyの認証フローの統合テスト

## フェーズ3.3: コア実装 (テストが失敗した後のみ)
- [ ] T008 [P] src/models/user.pyのユーザーモデル
- [ ] T009 [P] src/services/user_service.pyのUserService CRUD
- [ ] T010 [P] src/cli/user_commands.pyのCLI --create-user
- [ ] T011 POST /api/usersエンドポイント
- [ ] T012 GET /api/users/{id}エンドポイント
- [ ] T013 入力検証
- [ ] T014 エラー処理とロギング

## フェーズ3.4: 統合
- [ ] T015 UserServiceをDBに接続
- [ ] T016 認証ミドルウェア
- [ ] T017 リクエスト/レスポンスロギング
- [ ] T018 CORSとセキュリティヘッダー

## フェーズ3.5: 磨き上げ
- [ ] T019 [P] tests/unit/test_validation.pyの検証の単体テスト
- [ ] T020 パフォーマンステスト (<200ms)
- [ ] T021 [P] docs/api.mdを更新
- [ ] T022 重複を削除
- [ ] T023 manual-testing.mdを実行

## 依存関係
- 実装 (T008-T014) の前にテスト (T004-T007)
- T008はT009、T015をブロック
- T016はT018をブロック
- 磨き上げ (T019-T023) の前に実装

## 並列実行の例
```
# T004-T007を同時に起動:
タスク: 「tests/contract/test_users_post.pyのPOST /api/usersの契約テスト」
タスク: 「tests/contract/test_users_get.pyのGET /api/users/{id}の契約テスト」
タスク: 「tests/integration/test_registration.pyの登録の統合テスト」
タスク: 「tests/integration/test_auth.pyの認証の統合テスト」
```

## 注意事項
- [P] タスク = 異なるファイル、依存関係なし
- 実装前にテストが失敗することを確認
- 各タスクの後にコミット
- 回避: 曖昧なタスク、同じファイルの競合

## タスク生成ルール
*main()実行中に適用*

1. **契約から**:
   - 各契約ファイル → 契約テストタスク [P]
   - 各エンドポイント → 実装タスク
   
2. **データモデルから**:
   - 各エンティティ → モデル作成タスク [P]
   - 関係 → サービス層タスク
   
3. **ユーザーストーリーから**:
   - 各ストーリー → 統合テスト [P]
   - クイックスタートシナリオ → 検証タスク

4. **順序付け**:
   - セットアップ → テスト → モデル → サービス → エンドポイント → 磨き上げ
   - 依存関係は並列実行をブロック

## 検証チェックリスト
*ゲート: 戻る前にmain()によってチェックされます*

- [ ] すべての契約に対応するテストがある
- [ ] すべてのエンティティにモデルタスクがある
- [ ] すべてのテストは実装の前に来る
- [ ] 並列タスクは真に独立している
- [ ] 各タスクは正確なファイルパスを指定している
- [ ] 別の [P] タスクと同じファイルを変更するタスクがない
