# 機能仕様: TRPGルールブック公開サイトの基本レイアウトとコンテンツ表示

**機能ブランチ**: `001-trpg-web-markdown`  
**作成日**: 2025年9月23日  
**ステータス**: ドラフト  
**入力**: ユーザーの説明: "TRPGのルールブックを公開するWebサイトをつくりたい。まずはレイアウトとして、ヘッダー、フッター、サイトナビゲーション、ページ内目次を作りたい。スマホでもきれいに表示したい。スマホ表示のときはサイトナビゲーションはトグルで出したり隠したりしたい。ページ内目次はページによっては非表示にできるようにしたい。表示するコンテンツはmarkdownとして書きたい。複雑なレイアウトにしたいときはmarkdownの中でReactのコンポーネントを埋め込みたい。"

## 実行フロー (メイン)
```
1. 入力からユーザーの説明を解析
   → 空の場合: エラー "機能の説明が提供されていません"
2. 説明から主要な概念を抽出
   → 識別: アクター、アクション、データ、制約
3. 不明確な各側面について:
   → [要明確化: 具体的な質問] でマーク
4. ユーザーシナリオとテストセクションを記入
   → 明確なユーザーフローがない場合: エラー "ユーザーシナリオを決定できません"
5. 機能要件を生成
   → 各要件はテスト可能でなければならない
   → 曖昧な要件をマーク
6. 主要エンティティを識別 (データが関与する場合)
7. レビューチェックリストを実行
   → [要明確化] がある場合: 警告 "仕様には不確実性があります"
   → 実装の詳細が見つかった場合: エラー "技術的な詳細を削除してください"
8. 戻り値: 成功 (仕様は計画の準備ができています)
```

---

## ⚡ クイックガイドライン
- ✅ ユーザーが何を必要とし、なぜそれを必要とするかに焦点を当てる
- ✅ **静的サイトの原則**: すべての機能は静적サイトとして実現可能でなければならない
- ❌ 実装方法 (技術スタック、API、コード構造なし) を避ける
- 👥 開発者ではなく、ビジネス関係者向けに書かれている

### セクション要件
- **必須セクション**: すべての機能で完了する必要がある
- **オプションセクション**: 機能に関連する場合にのみ含める
- セクションが適用されない場合は、完全に削除する ("N/A" として残さない)

### AI生成用
ユーザープロンプトからこの仕様を作成する場合:
1. **すべての曖昧さをマークする**: 仮定する必要がある場合は、[要明確化: 具体的な質問] を使用する
2. **推測しない**: プロンプトで何かが指定されていない場合 (例: 認証方法のない「ログインシステム」)、それをマークする
3. **テスターのように考える**: すべての曖昧な要件は、「テスト可能で曖昧でない」チェックリスト項目に失敗する必要がある
4. **一般的な不特定領域**:
   - ユーザーの種類と権限
   - データ保持/削除ポリシー  
   - パフォーマンターゲットと規模
   - エラー処理の動作
   - 統合要件
   - セキュリティ/コンプライアンスのニーズ

---

## ユーザーシナリオとテスト *(必須)*

### 主要なユーザーストーリー
サイト訪問者は、TRPGのルールブックを読むためにサイトを訪れます。PCでもスマートフォンでも快適に閲覧でき、サイトナビゲーションやページ内目次を使って目的の情報を簡単に見つけることができます。コンテンツ作成者は、Markdown形式でルールを記述し、必要に応じて複雑なレイアウトのためにReactコンポーネントを埋め込むことができます。

### 受け入れシナリオ
1. **前提** ユーザーがサイトにアクセスしたとき, **いつ** PCで閲覧している, **そのとき** ヘッダー、フッター、常に表示されているサイトナビゲーション、コンテンツエリア、ページ内目次が表示される。
2. **前提** ユーザーがサイトにアクセスしたとき, **いつ** スマートフォンで閲覧している, **そのとき** ヘッダー、フッター、コンテンツエリアが表示され、サイトナビゲーションはトグルボタンで表示・非表示を切り替えられる。
3. **前提** コンテンツ作成者がページを作成するとき, **いつ** ページ内目次が不要だと判断した, **そのとき** そのページではページ内目次を非表示にする設定ができる。
4. **前提** コンテンツ作成者がコンテンツを記述するとき, **いつ** Markdown記法を使用する, **そのとき** h1, p, ul, liなどの基本的なMarkdownがHTMLに変換されて表示される。
5. **前提** コンテンツ作成者がコンテンツを記述するとき, **いつ** Markdown内に特定の記法でReactコンポーネントを指定する, **そのとき** 指定されたReactコンポーネントがその場にレンダリングされる。

## 要件 *(必須)*

### 機能要件
- **FR-001**: システムは、ヘッダー、フッター、サイトナビゲーション、コンテンツ表示エリアを持つ基本的なページレイアウトを**提供する必要があります**。
- **FR-002**: システムは、レスポンシブデザインに対応し、PCおよびスマートフォンで適切に表示される**必要があります**。
- **FR-003**: スマートフォン表示時、サイトナビゲーションはトグルボタンによって表示・非表示を切り替えられる**必要があります**。
- **FR-004**: ページごとにページ内目次の表示・非表示を選択できる**必要があります**。
- **FR-005**: Markdownで記述されたコンテンツをHTMLに変換して表示できる**必要があります**。
- **FR-006**: Markdownコンテンツ内にReactコンポーネントを埋め込み、表示できる**必要があります**。
- **FR-007**: 埋め込まれたReactコンポーネントでエラーが発生した場合、システムはビルド時に失敗する**必要があります**。
- **FR-008**: ヘッダーにはサイトタイトルを表示する**必要があります**。
- **FR-009**: フッターにはコピーライト表記を表示する**必要があります**。
- **FR-010**: サイトナビゲーションの項目は、静的な設定ファイルに基づいて表示される**必要があります**。

### 主要エンティティ *(機能にデータが含まれる場合に含める)*
- **ページ (Page)**: URLパス、Markdownコンテンツ、ページ内目次の表示/非表示フラグを持つ。
- **Reactコンポーネント (React Component)**: Markdown内で埋め込み可能な、再利用可能なUI部品。

---

## レビューと受け入れチェックリスト
*ゲート: main() 実行中に実行される自動チェック*

### コンテンツの品質
- [x] 実装の詳細 (言語、フレームワーク、API) がない
- [x] ユーザー価値とビジネスニーズに焦点を当てている
- [x] 非技術的な関係者向けに書かれている
- [x] すべての必須セクションが完了している

### 要件の完全性
- [x] [要明確化] マーカーが残っていない
- [x] 要件はテスト可能で曖昧でない  
- [x] 成功基準は測定可能である
- [x] スコープが明確に区切られている
- [x] 依存関係と仮定が特定されている

---

## 実行ステータス
*処理中に main() によって更新*

- [x] ユーザーの説明が解析された
- [x] 主要な概念が抽出された
- [x] 曖昧さがマークされた
- [x] ユーザーシナリオが定義された
- [x] 要件が生成された
- [x] エンティティが特定された
- [x] レビューチェックリストに合格した

---